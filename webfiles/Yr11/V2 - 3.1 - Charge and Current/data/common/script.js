//Version 1.0.2.6
function loadPres(e,t){function o(e,t){return e.indexOf(t,e.length-t.length)!==-1}gc=t||1;gv.b=t;if(isNaN(gc)){gc=1}gc=gc<1?1:gc;objDopEvnt.OnLoadingStart();gv.o("resizer").innerHTML="";var n=document.getElementsByTagName("head")[0].getElementsByTagName("script");for(var r=0;r<n.length;r++){if(o(n[r].src,"scriptInit.js")){document.getElementsByTagName("head")[0].removeChild(n[r])}}var i=gv.o("DopFontFamily");if(i){document.getElementsByTagName("head")[0].removeChild(i)}var s=document.createElement("script");s.setAttribute("type","text/javascript");s.src=gv.d+e+"/scriptInit.js";document.getElementsByTagName("head")[0].appendChild(s)}function loadContent(e,t,n){function l(){clearTimeout(gli);if(!cfc.l(gc)){gli=setTimeout(l,100);return}acc.t();if(gpc==gc){gStartTime=gtct-gslength[gc-1]}else if(gpc<gc){gStartTime-=gslength[gc-1]-anima["s"+gpc].f}else if(gpc>gc){gStartTime+=anima["s"+gpc].f-gslength[gc-1]}gt=gslength[gc-1];cfc.hf.add(gc);ncc.y()}var r=gv.o("resizer");var i=r.getAttribute("style");i+="-moz-font-feature-settings: 'liga' 0;-webkit-font-feature-settings: 'liga' 0;-ms-font-feature-settings: 'liga' 0;-o-font-feature-settings: 'liga' 0;font-feature-settings: 'liga' 0;text-rendering: optimizeSpeed;";r.setAttribute("style",i);var s;if(gv.bs){s=r.getElementsByClassName("SC")[0];s.innerHTML=n;anima["s"+t].s.b=true}else{r.innerHTML="";r.innerHTML=n.join("");r.innerHTML+=gv.e;cfc.q(gc)}var o,u,a,f;if(!(document.createElement("detect").style.textShadow==="")){if(gv.bs){u=s.getElementsByTagName("pre")}else{u=document.getElementsByTagName("pre")}for(f=0;f<u.length;f++){if(u[f].style.color!="transparent"){continue}a=u[f].getAttribute("style");o=a.indexOf("rgba");if(o<0){continue}a=a.substring(o,a.length);u[f].style.color=a.substring(0,a.indexOf(")")+1)}}gc=gc>gv.t?gv.t:gc;if(gv.bs){cfc.s(t);if(gc!=t){return}}else{cfc.s(gc)}l()}function play(){gStartTime=gStartTime+((new Date).getTime()-gtct);gpp=0;gafi=UpdategT();if(gafi==0){return}gp=1;objDopEvnt.OnPlayingStart()}function pause(){gpp=1;gp=0;objDopEvnt.OnPlayingEnd()}function scormGoTo(e){if(e!=""){gc=parseInt(e)}}function RListener(e){if(gv.q!=0){e.style.opacity=.7;return}gv.o("resizer").onclick=null}function AListener(e){if(gv.q!=0){e.style.opacity=1;return}if(gv.g==1){gv.o("resizer").onclick=ncc.n}}function hwr(e,t,n){var r=e.getElementsByTagName("div");if(r.length>0){if(DOPStyle.s(r[0],"opacity")==0&&e.getElementsByTagName("canvas").length==0){return}}else{if(DOPStyle.s(e.parentNode,"opacity")==0&&e.parentNode.parentNode.getElementsByTagName("canvas").length==0){return}}if(t==1){window.open(n)}if(t==0){ncc.z(n)}}var gc=1;var gd=0;var gli=0;var gln=0;var gpc=1;var au=[];var gx=0;var gxf=false;var gt=0;var gpp=1;var gp=0;var gStartTime=0;var gtct=0;var gafi=0;var gplength=0;var gslength=[];var fcon=0;var objDopPhSco;var objDopEvnt;var anima;var notes={};var gv={n:0,o:function(e){return document.getElementById(e)}};var DopPresentation=function(e){function t(){ncc.n()}function n(){ncc.p()}function r(){ncc.P()}function i(){ncc.Ps()}function s(e){return cfc.nt(e)}function o(){ncc.z(gc+1)}function u(){ncc.z(gc-1)}function a(e){ncc.z(e)}function f(){return cfc.dl()}function l(e){gv.d=e}function c(e,t){loadPres(e,t)}function h(e){gv.r=e}objDopEvnt=e;return{Next:t,Prev:n,Play:r,Pause:i,GetNotes:s,NxtSlide:o,PrvSlide:u,GotoSlide:a,GetContentDetails:f,SetRPath:l,LoadPres:c,SetScale:h}};var bla="(function()"+"{"+"var z=eval(y.s);"+"var oa=w('a');"+"oa.style.height=z[0]+'px';"+"oa.style.width=z[1]+'px';"+"oa.style.cursor='pointer';"+"oa.style.position='absolute';"+"oa.style.zIndex=1000;"+"var o=w('div');"+"u(o,'style','');"+"o.style.top=z[2]+'px';"+"o.style.left=z[3]+'px';"+"u(oa,'oncluck','hwr(this,1,\"'+z[4]+'\")');"+"var oo=w('ig');"+"if(!(z[0]==0||z[1]==0))"+"u(oo,'src','data:image/png;base64,'+y.i);"+"oa.appendChild(oo);"+"o.appendChild(oa);"+"gv.e=cTs(o);"+"var a=y.a;"+"gli=0; "+"gln=0; "+"gpc=1; "+"au=new Array(); "+"gx=0;"+"gxf=false;"+"gt=0;"+"gpp=1; "+"gp=0; "+"gStartTime=0;"+"gtct=0;"+"gafi=0;"+"gplength=0;"+"gslength=new Array();"+"fcon=0;"+"gv.h=a.h;"+"gv.w=a.w;"+"gv.v=a.v;"+"gv.t=a.t;"+"gv.a=a.a;"+"gv.s=a.s;"+"gv.i=a.i;"+"gv.f=a.f;"+"gv.l=a.l;"+"gv.c=a.c;"+"gv.p=a.p;"+"gv.q=a.q;"+"gv.bs=a.bs;"+"gv.g=a.g;"+"gv.j=a.j;"+"gv.k=a.k;"+"gv.loop=a.lop;"+"anima=a.an;"+"gft=a.ft;"+"gv.bc='rgba'+a.rgba;"+"notes=y.n;"+"for(var i=1;i<=gv.t;i++){"+"anima['s'+i].s={"+"a:false,"+"b:false,"+"c:false,"+"d:false"+"};"+"}"+"cfc.g();"+"var s;"+"d=function(b,n)"+"{"+"return b.indexOf(n,b.length-n.length)!==-1;"+"};"+"var e=document.getElementsByTagName('head')[0].getElementsByTagName('script');"+"for(var i=0;i<e.length;i++)"+"{"+'if(d(e[i].src,"slideVault.js")||d(e[i].src,"scriptInit.js"))'+"{"+"document.getElementsByTagName('head')[0].removeChild(e[i]);"+"}"+"}"+"e=document.getElementsByTagName('head')[0].getElementsByTagName('link');"+"for(i=0;i<e.length;i++)"+"{"+'if(d(e[i].href,"styleVault.css")||d(e[i].href,"template.css"))'+"{"+"document.getElementsByTagName('head')[0].removeChild(e[i]);"+"}"+"}"+"s=document.createElement('link');"+"s.setAttribute('rel','stylesheet');"+"s.setAttribute('href',gv.d+gv.a+'/styleVault.css');"+"document.getElementsByTagName('head')[0].appendChild(s);"+"})"+"();";var init=function(){function l(e){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");for(var n=0;n<t.length;n++){v[t[n]]=n}e=e.replace(new RegExp("[^"+t.join("")+"=]","g"),"");var r=e.charAt(e.length-1)=="="?e.charAt(e.length-2)=="="?"AA":"A":"";var i="";e=e.substr(0,e.length-r.length)+r;for(var s=0;s<e.length;s+=4){var o=(v[e.charAt(s)]<<18)+(v[e.charAt(s+1)]<<12)+(v[e.charAt(s+2)]<<6)+v[e.charAt(s+3)];i+=String.fromCharCode(o>>>16&255,o>>>8&255,o&255)}return i.substring(0,i.length-r.length)}function k(e){return e.substring(0,e.indexOf("{"))}function m(e){return e.substring(e.indexOf("{")+1)}function j(s){return eval(s)}function w(e){return document.createElement(e)}function x(e,t){return t.appendChild(e)}function u(e,t,n){e.setAttribute(t,n)}function cTs(e){var t=document.createElement("div");t.appendChild(e);return t.innerHTML}function siv(){gslength[0]=0;var e;for(var t=1;t<=gv.t;t++){e=anima["s"+t];e.f=gslength[t]=gslength[t-1];gslength[t]+=e.t.i;e=e.c;if(e!=0){for(n in e){if(typeof e[n].i!="undefined"){gslength[t]+=e[n].i}}}}gplength=gslength[gslength.length-1]}var v={};var y={};var t=function(e,t,n){y.t=e.substring(0,5);e=e.substring(5);y.i=k(e);e=m(e);var r=k(e);var i=l(r);y.a=j(i);e=m(e);r=k(e);i=l(r);y.f=i;y.f=bla;e=m(e);y.s=l(e);y.n=t;j(y.f);cfc.f(n,gft);siv();var s;try{objDopEvnt.InitaliseSettings(cfc.dl())}catch(o){}try{if(gv.s!=0){s=presenter.loadXml("courseInfo.xml");Player.SetPresenterDetails(s)}}catch(u){}if(gv.q!=0){if(typeof zenler!="undefined"){var a=zenler.GetStringFromCurrentNode();qSC.loadXmlFrmTxt(a)}else{gv.q.zXml=""}}var f=gv.o("resizer");if(gv.bs){var c='<div class="SC" id="s'+gv.b+'s0"></div>';f.innerHTML+=c}f.style.backgroundColor=gv.bc;if(gv.s!=0){objDopPhSco=new DopPhSco(gv.s);objDopPhSco.Load()}if(gv.q!=0){var h=document.createElement("link");h.setAttribute("rel","stylesheet");h.setAttribute("href",gv.d+gv.a+"/template.css");document.getElementsByTagName("head")[0].appendChild(h);if(gv.s==0){qsh.initQuestionStruct();qSC.loadQuizFromXml()}}try{document.createEvent("TouchEvent");if("ontouchstart"in window){gd=1}else{gd=0}}catch(p){gd=0}if(gd==1){if(gv.q==0){f.ontouchstart=function(e){function n(e){return e.changedTouches[0].clientX}var t=n(e);f.ontouchend=function(r){var i=n(r);f.ontouchmove=f.ontouchend=null;if(t-i>100&&gv.j==1){ncc.n()}else if(t-i<-100&&gv.j==1){ncc.p()}else if(Math.abs(t-i)<10){var s=d(gc,e.target);if(s==""){var o=v(gc,e.target);if(o.DopPhGoto){hwr(o,0,o.DopPhGoto)}else if(o.DopPhVdo){video(o)}else if(o.DopPhAdo){audio(o)}}else{try{window.open(s,"_blank")}catch(u){}}}};return false};function d(e,t){var n="s"+e+"s"+0;try{while(t.id!=n){if(t.tagName.toLowerCase()=="a"){return t.href}t=t.parentNode}}catch(r){return""}return""}function v(e,t){var n="s"+e+"s"+0;try{while(t.id!=n){if(t.DopPhGoto||t.DopPhVdo||t.DopPhAdo){return t}t=t.parentNode}}catch(r){return""}return""}}else{f.ontouchstart=null}}else{if(gv.q==0&&gv.g==1){f.onclick=ncc.n}else{f.onclick=null}}if(gv.q==0&&gv.k==1){document.body.onkeydown=function(e){var t;if(!e)e=window.event;if(e.keyCode)t=e.keyCode;else if(e.which)t=e.which;if(t==39||t==40){ncc.n()}if(t==37||t==38){ncc.p()}}}else{document.body.onkeydown=null}slideLoader.adSldScrpt(gc);cfc.q(gc)};return t}();var slideLoader=function(){function e(e){if(anima["s"+e].s.a){return}if(gln===0){gln=1;objDopEvnt.OnLoadingStart()}var t="";if(gv.bs){t=e;anima["s"+e].s.a=true}var n=document.createElement("script");n.setAttribute("charset","UTF-8");n.setAttribute("src",gv.d+gv.a+"/slideVault"+t+".js");document.getElementsByTagName("head")[0].appendChild(n)}return{adSldScrpt:e}}();Cbfun=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){return window.setTimeout(e,1e3/60)}}();UpdategT=function(){if(gpp==1)return null;gtct=(new Date).getTime();gt=gtct-gStartTime;objDopEvnt.OnProgressChange(gt);if(gx==1){if(gt>=gslength[gc-1]+anima["s"+gc].t.i){if(gxf){gxf=false;tranend(1);return 0}else{gxf=true}}gafi=Cbfun(UpdategT);return null}anima["s"+gc].f=gt;if(gt>=acc.g[anima["s"+gc].g]){pause();var e=gt-acc.g[anima["s"+gc].g];gtct=gtct-e;anima["s"+gc].f=gt=acc.g[anima["s"+gc].g];anima["s"+gc].g++;if(fcon==1){if(typeof acc.g[anima["s"+gc].g]!="undefined"){objDopEvnt.OnMovToNxtAnim();acc.P();play()}fcon=0}else if(anima["s"+gc].a==1){if(typeof acc.g[anima["s"+gc].g]!="undefined"){acc.P();play()}else{ncc.n()}}return 0}gafi=Cbfun(UpdategT);return null};AnCl=function(){function z(c,q){for(n in c){if(n!="i"){switch(c[n].c4){case 1:case 2:if(c[n].v==0){if(typeof window[c[n].c5]!="undefined"){c[n].v=eval("new "+c[n].c5+"(c[n])")}else{c[n].v=new Fade(c[n])}c[n].v.Initialize(q)}break;case 3:if(c[n].v==0){if(typeof window[c[n].c5]!="undefined"){c[n].v=eval("new "+c[n].c5+"(c[n])")}else{c[n].v=new Spin(c[n])}c[n].v.Initialize(q)}break;case 4:if(c[n].v==0){c[n].v=eval("new "+c[n].c5+"(c[n])");c[n].v.Initialize(q)}break;case 5:if(c[n].v==0){switch(c[n].c5){case 5:c[n].v=new aVideo(c[n],q);break;case 6:c[n].v=new aVideo(c[n],q);break;case 7:c[n].v=new aVideo(c[n],q);break}}break;case 8:if(c[n].v==0){switch(c[n].c5){case 8:c[n].v=new aaudio(c[n],q);break;case 9:c[n].v=new aaudio(c[n],q);break;case 0:c[n].v=new aaudio(c[n],q);break}}break;case"n":c[n].v=new autoAdvance(c[n]);break}}}}this.g=new Array;this.P=function(){var e=this.l();for(var t=0;t<e.length;t++){if(e[t].IniTSd){e[t].play()}}};this.p=function(){var e=this.l();for(var t=0;t<e.length;t++){if(e[t].IniTSd){e[t].pause()}}};this.s=function(){var e=this.l();for(var t=0;t<e.length;t++){if(e[t].IniTSd){e[t].stop()}}};this.r=function(){var e=this.l();for(var t=0;t<e.length;t++){if(e[t].IniTSd){e[t].reset()}}};this.t=function(){this.g.splice(0,this.g.length);var e=anima["s"+gc];var t=e.t.i;e=e.c;if(e!=0){for(var n in e){if(n!="i"){t+=e[n].i;this.g[this.g.length]=gslength[gc-1]+t}}}else{this.g[0]=0}};this.l=function(){var e=new Array;var t=anima["s"+gc].g;var n=anima["s"+gc];n=n.c;n=n["c"+t];for(var r in n){if(r!="i"){if(n[r].v==0){z(n,this.g[anima["s"+gc].g]-n.i)}e[e.length]=n[r].v}}return e}};var acc=new AnCl;NvCl=function(){function e(e,n){e.p=gv.o("narration"+n);try{t(e)}catch(r){}}function t(e){e.p.height=e.h;e.p.width=e.w;e.p.setAttribute("style","top:"+e.t+"px;left:"+e.l+"px;position:absolute;");e.p.play()}this.P=function(){var e;if(gp==0){for(e=0;e<au.length;e++){au[e][0].play()}if(acc.g[anima["s"+gc].g]>gt){play();acc.P();return}ncc.n();return}pause();for(e=au.length;e>=0;e--){if(typeof au[e]!="undefined"){if(typeof au[e][0]!="undefined"){au[e][0].pause()}}}acc.p()};this.Ps=function(){pause();for(var e=au.length-1;e>=0;e--){au[e][0].pause()}};this.n=function(e){function r(t){if(gc<gv.t||e==1||t){if(gpc==0&&!gv.bs){gpc=gc;cfc.sn(gc);cfc.hf.remove(gc)}if(e!=1){if(t){gc=1}else{gc++}if(gv.bs){cfc.q(gc);gc=parseInt(gv.b)}else{cfc.q(gc)}if(gv.bs){if(!anima["s"+gv.b].s.a){slideLoader.adSldScrpt(gv.b)}if(!anima["s"+gv.b].s.b){gli=setTimeout(function(){ncc.n(1)},50);if(gln===0){objDopEvnt.OnLoadingStart();gln=1}}return}cfc.s(gc)}if(!cfc.l(gc)){gli=setTimeout(function(){ncc.n(1)},50);return}anima["s"+gc].g=0;var r=function(){if(e<1||e>gv.t){return 0}var t=new Array;var r=anima["s"+e];r=r.c;if(r!=0){for(n in r){if(n!="i"){var i=r[n];for(var s in i){if(s!="i"){if(i[s].v!=0){t[t.length]=i[s].v}else{return t}}}}}}return t};for(var i=r.length-1;i>0;i--){r[i].reset()}cfc.m();anima["s"+gc].f=gt=gslength[gc-1];gStartTime=gStartTime-(gslength[gc-1]-anima["s"+gpc].f);acc.t();ncc.y();cfc.hf.add(gc);if(gv.s!=0){objDopPhSco.UpdateLesson(gc,gv.t)}}}if(gx==1){tranend();return}if(e!=1&&gln!=0){if(gc==gv.t){return}clearTimeout(gli);r(false);return}if(e!=1&&gln==0){if(gslength[gc]<=gt&&(anima["s"+gc].g>=acc.g.length||anima["s"+gc].c==0)){if(gc==gv.t){ncc.a(1);if(gv.loop){r(true)}return}pause();if(anima["s"+gc].f<anima["s"+gc].c.i){anima["s"+gc].g++}r(false);return}if(gp==1){gStartTime=gStartTime-(acc.g[anima["s"+gc].g]-gt);anima["s"+gc].f=gt=acc.g[anima["s"+gc].g];objDopEvnt.OnProgressChange(gt);fcon=1;return}if(acc.g[anima["s"+gc].g]>=gt){if(gp==1){pause();gStartTime=gStartTime+gt-acc.g[anima["s"+gc].g];anima["s"+gc].f=gt=acc.g[anima["s"+gc].g];objDopEvnt.OnProgressChange(gt);anima["s"+gc].g++}else{objDopEvnt.OnMovToNxtAnim();acc.P();for(var t=0;t<au.length;t++){au[t][0].play()}play()}return}}r(false)};this.p=function(e){function t(t){clearTimeout(gli);if(gpc==0){gpc=gc;cfc.sn(gc);cfc.hf.remove(gc)}if(e!=1){if(t){gc=gv.t}else{gc--}if(gv.bs){cfc.q(gc);gc=parseInt(gv.b)}else{cfc.q(gc)}if(gv.bs&&!anima["s"+gv.b].s.a){slideLoader.adSldScrpt(gv.b)}if(gv.bs&&!anima["s"+gv.b].s.b){gli=setTimeout(function(){ncc.p(1)},50);if(gln===0){objDopEvnt.OnLoadingStart()}return}cfc.s(gc)}if(gv.bs&&!anima["s"+gv.b].s.c){return}if(!cfc.l(gc)){gli=setTimeout(function(){ncc.p(1)},100);return}n()}function n(){cfc.hf.add(gc);cfc.m();acc.t();gStartTime=gStartTime+(anima["s"+gpc].f-gslength[gc-1]);gt=gslength[gc-1];objDopEvnt.OnProgressChange(gt);ncc.y()}if(gx==1){tranend();return}if(e!=1&&gln!=0){if(gc==1){ncc.a(0);return}t(false);return}if(e!=1&&gln==0){if(gt-anima["s"+gc].t.i>gslength[gc-1]){if(gp==1){pause()}else{if(acc.g.indexOf(gt)>-1)anima["s"+gc].g--}acc.r();acc.s();if(anima["s"+gc].g>0){gStartTime=gStartTime+(gt-acc.g[anima["s"+gc].g-1]);anima["s"+gc].f=gt=acc.g[anima["s"+gc].g-1]}else{gStartTime=gStartTime+(gt-gslength[gc-1]-anima["s"+gc].t.i);anima["s"+gc].f=gt=gslength[gc-1]+anima["s"+gc].t.i}objDopEvnt.OnMovToPrvAnim();objDopEvnt.OnProgressChange(gt);return}else{if(gc>1){t(false)}else if(gv.loop){t(true)}}}};this.z=function(e){function t(e){pause();acc.s();if(gv.bs){if(!anima["s"+e].s.a){slideLoader.adSldScrpt(e)}if(!anima["s"+e].s.b){return}}cfc.s(e)}function n(){clearTimeout(gli);if(gv.bs&&!anima["s"+gv.bs].s.c){return}if(!cfc.l(gc)){gli=setTimeout(function(){n()},100);return}acc.t();gStartTime=gStartTime-(gslength[gc-1]-anima["s"+gpc].f);i();cfc.q(gc)}function r(){clearTimeout(gli);if(gv.bs&&!anima["s"+gv.bs].s.c){return}if(!cfc.l(gc)){gli=setTimeout(function(){r()},100);return}acc.t();gStartTime=gStartTime+(anima["s"+gpc].f-gslength[gc-1]);i();cfc.q(gc)}function i(){gt=gslength[gc-1];objDopEvnt.OnProgressChange(gt);cfc.hf.add(gc);ncc.y()}function s(){cfc.q(gc);cfc.m()}e=parseInt(e);if(isNaN(e)){return}if(gpc==0){gpc=gc;cfc.sn(gc);cfc.hf.remove(gc)}if(e==gv.t||e>gv.t){t(gv.t);gc=gv.t;s();n()}else if(e>gc){t(e);gc=e;s();n()}else if(e==gc)return;else if(e>0){t(e);gc=e;s();r()}else if(e<0){t(1);gc=1;s();r()}};this.y=function(){var t=anima["s"+gc];if(typeof t.q!="undefined"){var n=qsh.initQuestionSlide();if(n>0){ncc.z(n);return}}if(t.n!=0){e(t.n,gc)}t=anima["s"+gc].t;if(t.c!=0){if(t.v==0){t.v=new tran(t.c);t.v.initialize(gslength[gc-1])}t.v.play();play()}else{if(gpc!=gc&&gpc>0){var r=gv.o("s"+gpc+"s0");if(r!=null){gv.o("s"+gpc+"s0").style.display="none"}}gv.o("s"+gc+"s0").style.display="block";gpc=0;gt=anima["s"+gc].f;gStartTime=gStartTime-(gt-gslength[gc-1]);objDopEvnt.OnProgressChange(gt);if(anima["s"+gc].f==gslength[gc-1]+anima["s"+gc].t.i){if(anima["s"+gc].t.n==1){acc.P();play()}}else if(acc.g.indexOf(anima["s"+gc].f)==-1){acc.P();play()}}};this.a=function(e){if(gv.s!=0){if(!objDopPhSco.scormendStatus){objDopPhSco.Quit()}objDopPhSco.scormendStatus=true}if(typeof loadCourseXml=="undefined"){return}if(e==1){cfc.q(-1)}else{cfc.q(0)}}};var ncc=new NvCl;Cfc=function(){function e(e){function s(e){if(e.getElementsByTagName("video").length>0){e.DopPhVdo=true}else if(e.getElementsByTagName("audio").length>0){e.DopPhAdo=true}}function o(e){var t=document.createElement("a");t.setAttribute("style",e.getAttribute("style"));t.innerHTML=e.innerHTML;t.className="DopPhAnchor "+e.className;try{a(t,e)}catch(n){}t.onmouseout=e.onmouseout;t.onmouseover=e.onmouseover;var r=e.parentNode;r.appendChild(t);r.removeChild(e)}function u(e){var t=e.childNodes;var n=e;if(t[0].tagName.toLowerCase()==="div"){n=t[0]}var r=document.createElement("a");r.setAttribute("style","height:100%;width:100%;top:0px;left:0px;");r.innerHTML=n.innerHTML;r.className="DopPhAnchor";try{a(r,e)}catch(i){}r.onmouseout=e.onmouseout;r.onmouseover=e.onmouseover;e.setAttribute("onclick","");n.innerHTML="";n.appendChild(r)}function a(e,t){var n=document.createElement("div");n.innerHTML=t.onclick;var r=n.innerHTML;var i=r.split(",");if(i[1]==2){e.setAttribute("target","_blank");e.href=gv.d+gv.a+"/"+i[2].split("'")[1]}else if(i[1]==1){e.setAttribute("target","_blank");e.href=i[2].split("'")[1]}else if(i[1]==0){e.DopPhGoto=i[2].split(")")[0];e.setAttribute("onclick","");e.onclick=function(e){hwr(e.target,0,i[2].split(")")[0])}}}var n=gv.o("s"+e+"s"+0);var r=t(n,"onclick");for(var i=r.length-1;i>=0;i--){if(r[i].tagName.toLowerCase()==="pre"){o(r[i])}else if(r[i].tagName.toLowerCase()==="div"){if(r[i].getElementsByTagName("video").length>0||r[i].getElementsByTagName("audio").length>0){s(r[i])}else{u(r[i])}}}}function t(e,t){var n=[];var r=e.getElementsByTagName("*");for(var i=0;i<r.length;i++){if(r[i].getAttribute(t)){n[n.length]=r[i]}}return n}this.l=function(e){if(gv.i[e]==-1){if(gln==1){objDopEvnt.OnLoadingEnd()}else{gln=0}return true}if(gv.bs&&!anima["s"+e].s.b){return false}if(window.location.host!=""){var t=gv.o("s"+e+"s0").getElementsByTagName("img");try{if(t.length==0){throw"adsf"}}catch(n){}var r=t.length-1;for(;r>=0;r--){if(!t[r].complete){if(gln===0){objDopEvnt.OnLoadingStart()}gln=1;return false}}if(!(navigator.platform.indexOf("iPhone")!=-1||navigator.platform.indexOf("iPod")!=-1||navigator.userAgent.match(/iPad/i)!=null)){t=gv.o("s"+e+"s0").getElementsByTagName("audio");for(r=t.length-1;r>=0;r--){if(t[r].dopLoaded==0){if(gln===0){objDopEvnt.OnLoadingStart()}gln=1;return false}}t=gv.o("s"+e+"s0").getElementsByTagName("video");for(r=t.length-1;r>=0;r--){if(t[r].dopLoaded==0){if(gln===0){objDopEvnt.OnLoadingStart()}gln=1;return false}}}}objDopEvnt.OnLoadingEnd();gln=0;gv.i[e]=-1;anima["s"+e].s.d=true;return true};this.s=function(t){for(var r=t-2;r<t+5;r++){if(gv.bs){r=t}if(r<1||r>gv.t){continue}if(gv.bs&&!anima["s"+r].s.b){return}if(gv.bs&&anima["s"+r].s.c){return}if(gv.i[r]<1){continue}var i=gv.o("s"+r+"s0");var s=i.getElementsByTagName("img");var o;s[0].src=gv.d+gv.a+"/sb"+gv.i[r]+gv.c;var u=1;for(;u<s.length;u++){var a;if(s[u].src==""){a=".png"}else{a=".gif"}o=s[u].parentNode;s[u].src=gv.d+gv.a+"/"+o.id.replace("c","")+a}s=i.getElementsByTagName("video");var f;for(u=0;u<s.length;u++){var l;o=s[u].parentNode;if(s[u].id.indexOf("narration")!=-1){l="narration"+r}else{l="v"+o.parentNode.id}f=document.createElement("video");f.setAttribute("height",s[u].height);f.setAttribute("width",s[u].width);f.setAttribute("id",l);f.dopLoaded=0;f.addEventListener("canplaythrough",function(){this.dopLoaded=1},false);if(gv.v=="mp3"){f.setAttribute("src",gv.d+gv.a+"/"+l+".mp4")}else{f.setAttribute("src",gv.d+gv.a+"/"+l+".ogg")}f.setAttribute("preload","");f.setAttribute("webkit-playsinline","");o.removeChild(s[u]);o.appendChild(f);try{f.load()}catch(c){f.dopLoaded=1}}s=i.getElementsByTagName("audio");for(u=0;u<s.length;u++){o=s[u].parentNode;f=document.createElement("audio");f.dopLoaded=1;addEventListener("canplaythrough",function(){this.dopLoaded=1},false);if(gv.v=="mp3"){f.setAttribute("src",gv.d+gv.a+"/a"+o.id+".mp3")}else{f.setAttribute("src",gv.d+gv.a+"/a"+o.id+".ogg")}f.setAttribute("id","a"+o.id);f.setAttribute("preload","");o.removeChild(s[u]);o.appendChild(f);try{f.load()}catch(c){f.dopLoaded=1}}s=anima["s"+r];s=s.c;for(n in s){if(n!="i"){for(var h in s[n]){if(h!="i"){if(typeof s[n][h].c6!="undefined"&&s[n][h].c5!=5&&s[n][h].c5!=6&&s[n][h].c5!=7&&s[n][h].c5!=8&&s[n][h].c5!=9&&s[n][h].c5!=0){if(gv.v==="mp3"){f=document.createElement("audio");f.setAttribute("id",s[n][h].c6);f.setAttribute("src",gv.d+gv.a+"/"+s[n][h].c6+".mp3");i.appendChild(f)}else{f=document.createElement("audio");f.setAttribute("id",s[n][h].c6);f.setAttribute("src",gv.d+gv.a+"/"+s[n][h].c6+".ogg");i.appendChild(f)}}}}}}anima["s"+r].s.c=true;e(r);gv.i[r]=0;if(gv.bs){return}}};this.q=function(e){objDopEvnt.OnSlideChange(e)};this.r=function(e){e=e+".js";var t=cfc.c(document.getElementsByTagName("head")[0],e,"script");if(t!=null){document.getElementsByTagName("head")[0].removeChild(t)}};this.c=function(e,t,n){function s(e,t){return e.indexOf(t,e.length-t.length)!==-1}var r=e.getElementsByTagName(n);for(var i=0;i<r.length;i++){if(s(r[i].src,t)){return r[i]}}return null};this.g=function(){var e={ogg:false,mp3:false};var t=document.createElement("audio");try{if(!!t.canPlayType){if(gv.v===0){e.mp3=true}else if(t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,"")){e.ogg=true}else if(t.canPlayType("audio/mpeg;").replace(/^no$/,"")){e.mp3=true}}else{gv.v=0;return}}catch(n){gv.v=0;return}gv.v=e.mp3?"mp3":"ogg"};this.f=function(e,t){if(e.length==0){return}var n=document.createElement("style");var r=document.createElement("div");var i="giItT1WQy@!-/#";n.setAttribute("type","text/css");n.setAttribute("id","DopFontFamily");for(var s=0;s<e.length;s++){n.innerHTML=n.innerHTML+'@font-face{font-family: "'+e[s][0]+'";src:local("'+e[s][1]+'"),url("'+gv.d+gv.a+"/"+e[s][0]+"."+t+'");}';var o=document.createElement("pre");o.setAttribute("style","font-family:"+e[s]+";color:"+gv.bc+";");o.innerHTML=i;r.appendChild(o)}var u=document.getElementsByTagName("head")[0];u.appendChild(n);var a=gv.o("resizer");a.appendChild(r)};this.a=function(e,t){if(typeof e=="undefined"||typeof e.play=="undefined"){return}var n=[e,t];for(var r=0;r<au.length;r++){if(au[r][0].id==e.id){if(au[r][1]<t){au[r][1]=t}return}}au[au.length]=n};this.m=function(){function t(e){if(gv.v!=0){var t=au[e][0];try{if(!t.paused){t.pause()}if(t.currentTime!=0){t.currentTime=0}}catch(n){}}}for(var e=0;e<au.length;e++){if(au[e][1]==1){t(e);au.splice(e,1);e--}else{au[e][1]--}}};this.nt=function(e){var t;if(typeof notes=="undefined"){t=""}else{t=notes["s"+e]}if(typeof t=="undefined"){t=""}return t};this.dl=function(){var e={};try{e.Width=gv.w;e.Height=gv.h;e.TotalSlides=gv.t;e.TotalTime=gplength;e.Notes=notes;e.MaxScale=gv.f;e.BackColr=gv.bc}catch(t){e=null}return e};this.sn=function(e){var t=gv.o("narration"+e);if(t!=null){t.currentTime=0;t.pause()}};this.pn=function(e){var t=gv.o("narration"+e);if(t!=null){t.play()}};this.hf=function(){function e(e){var t=document.getElementById("s"+e+"s0");var r=t.getElementsByTagName("embed");for(var i=r.length-1;i>=0;i--){var s=r[i].parentNode;var o="f"+s.id;if(gv.o(o)!=null){continue}var u=r[i].src,a,f={src:"",delay:0,openInNewWindow:false},l=document.createElement("div");if(u===""){a=document.createElement("embed")}else{a=document.createElement("iframe")}a.setAttribute("id",o);a.setAttribute("height","100%");a.setAttribute("width","100%");a.setAttribute("style","position:absolute;top:0px;left:0px;border:none;");if(u===""){f.src=gv.d+gv.a+"/f"+s.id+".swf";a.setAttribute("src",f.src);a.setAttribute("wmode","transparent")}else{u=u.split("+++");f.src=u[0];if(u[1]){f.delay=parseFloat(u[1])}if(u[2]){f.openInNewWindow=u[2].toLowerCase().replace("/","")==="true"}}var c=parseInt(s.style.top),h=parseInt(s.style.left),p=parseInt(s.style.width),d=parseInt(s.style.height),v;if(d+c<0||p+h<0||c>gv.h||h>gv.w){c=h=d=p=0}if(c<0){v=c;c=0;d+=v}if(h<0){v=h;h=0;p+=v}if(d+c>gv.h){d=gv.h-c}if(p+h>gv.w){p=gv.w-h}l.setAttribute("style","top:"+c/gv.h*100+"%;left:"+h/gv.w*100+"%;height:"+d/gv.h*100+"%;width:"+p/gv.w*100+"%;-webkit-overflow-scrolling:touch;overflow:auto;");l.setAttribute("eCntnt","true");s=gv.o("resizer");s=s.parentNode;a.DopOtherOptions=f;(function(){var e=a;e.style.display="none";e.DopTimeOut=function(e){e.parentNode.style.display="block";if(e.DopOtherOptions.openInNewWindow){e.src="";window.open(e.DopOtherOptions.src)}else{if(!n(e)){return}e.src=e.DopOtherOptions.src;e.style.display="block"}};l.DopTimeOutKey=setTimeout(function(){e.DopTimeOut(e)},f.delay)})();if(!f.openInNewWindow){l.appendChild(a)}s.appendChild(l);l.style.display="none"}}function t(){var e=gv.o("resizer");e=e.parentNode;var t=e.childNodes;var n=[];for(var r=t.length-1;r>=0;r--){if(typeof t[r].tagName=="undefined")continue;var i=t[r].getAttribute("eCntnt")=="true";if(i){n[n.length]=t[r];if(t[r].DopTimeOutKey){clearTimeout(t[r].DopTimeOutKey)}}}for(r=n.length-1;r>=0;r--){e.removeChild(n[r])}}function n(e){if(location.protocol!="https:"){return true}var t=e.DopOtherOptions.src;if(t.indexOf("https:")==0){return true}else if(t.indexOf("http:")==0){var n=document.createElement("a");n.innerHTML=t+"</br> "+"!! WARNING !! </br> Trying to load insecure content in secure page. Please click here to open content in new window.";n.setAttribute("href",t);n.setAttribute("target","blank");e.parentNode.appendChild(n);n.setAttribute("style","color:black;font-family:arial;position:absolute;background-color:#b2b2b9");return false}return true}return{add:e,remove:t}}()};var cfc=new Cfc;var presenter=function(){function e(e){var i={},s=r(e);for(var o=0;o<s.childNodes.length;o++){if(s.childNodes[o].nodeName.toLowerCase()=="presenter"){var u=s.childNodes[o];i["Presenter"]=t(u)}else if(s.childNodes[o].nodeName.toLowerCase()=="attachments"){var a=s.childNodes[o].childNodes;var f=n(a);i["Attachment"]=f}}return i}function t(e){var t={},n,r,i;t["Details"]={};for(r=0;r<e.attributes.length;r++){n=e.attributes[r];t["Details"][n.name]=n.value}var s=e.childNodes;for(var o=0;o<s.length;o++){if(s[o].nodeName.toLowerCase()=="#text"){continue}i=s[o];t[i.nodeName]={};for(r=0;r<i.attributes.length;r++){n=i.attributes[r];t[i.nodeName][n.name]=n.value}}return t}function n(e){var t={},n,r,i;for(i=0;i<e.length;i++){if(e[i].nodeName.toLowerCase()=="#text"){continue}t[i]={};r=e[i];for(var s=0;s<r.attributes.length;s++){n=r.attributes[s];t[i][n.name]=n.value}}return t}function r(e){var t;if(window.XMLHttpRequest){t=new XMLHttpRequest}else{t=new ActiveXObject("Microsoft.XMLHTTP")}t.open("GET",e,false);t.send();var n=t.responseXML;for(var r=0;r<n.childNodes.length;r++){if(n.childNodes[r].nodeName=="Course"){return n.childNodes[r]}}return n}return{loadXml:e}}();var arrayOfDivs=new Array;var larrayOfDivs=new Array;var gdS=new Object;QuestionHandler=function(){function e(e){var t;if(e[0]==1||e[0]==2||e[0]==3){var n=false;for(t=0;t<arrayOfDivs.length;t++){if(arrayOfDivs[t].c==1){n=true}}if(!n){if(e[0]==1||e[0]==2){alert("Please choose an answer and then click Submit button.")}else{alert("Please select at least one answer and then click Submit button.")}return false}}else{for(t=0;t<arrayOfDivs.length;t++){if(e[0]==5&&arrayOfDivs[t].c==0){alert("Please match the answers and then click submit button.");return false}}arrayOfDivs.sort(function(e,t){return parseInt(e.style.top)-parseInt(t.style.top)});for(t=0;t<arrayOfDivs.length;t++){if(e[0]==5&&arrayOfDivs[t].c==0){arrayOfDivs[t].c=-1}else{arrayOfDivs[t].c=t}}}return true}function t(e){if(!gv.q.sCW){e=0}switch(e){case 0:case 1:ncc.z(gc+1);break;case 2:ncc.z(gc+2);break}}function n(e,t){function f(e){var t=[];for(var n=0,r=e.length;n<r;n++){var i=t.length;t[i]={};t[i].h=parseInt(e[n].style.height);t[i].w=parseInt(e[n].style.width);t[i].t=parseInt(e[n].style.top);t[i].l=parseInt(e[n].style.left);t[i].node=e[n]}return t}gdS.node=t;gdS.node.style.zIndex=10;gdS.node.style.opacity=.8;gdS.node.style.webkitTransform="scale(1.05)";gdS.node.style.MozTransform="scale(1.05)";gdS.node.style.OTransform="scale(1.05)";gdS.node.style.msTransform="scale(1.05)";gdS.dAray=f(arrayOfDivs);var n,i;if(gd==1){n=e.changedTouches[0].clientX;i=e.changedTouches[0].clientY}else{n=e.clientX;i=e.clientY}var o=qSC.findPos(gv.o("resizer"));n-=o[0];i-=o[1];var u=parseInt(gdS.node.style.left);var a=parseInt(gdS.node.style.top);gdS.comX=n/gv.r-u;gdS.comY=i/gv.r-a;e.preventDefault();qSC.unclip(gdS.node);r(e);if(gd==1){document.addEventListener("touchmove",r,true);document.addEventListener("touchend",s,true)}else{document.addEventListener("mousemove",r,true);document.addEventListener("mouseup",s,true)}}function r(e){var t,n;if(gd==1){t=e.changedTouches[0].clientX;n=e.changedTouches[0].clientY}else{t=e.clientX;n=e.clientY}var r=qSC.findPos(gv.o("resizer"));t-=r[0];n-=r[1];var s=t/gv.r-gdS.comX;var o=n/gv.r-gdS.comY;gdS.node.style.left=s+"px";gdS.node.style.top=o+"px";i(s,o);e.preventDefault()}function i(e,t){var n=parseInt(gdS.node.style.width);var r=parseInt(gdS.node.style.height);var i=t+r/2;var s=gdS.dAray.length-1;var o=null;while(s>=0){if(gdS.dAray[s].t<i&&i<gdS.dAray[s].t+gdS.dAray[s].h){o=gdS.dAray[s].node.id;break}s--}if(o==gdS.node.id||o==null||gdS.dAray[s].node.c!=0){return}var u=gdS.dAray[s].l<=e&&e<gdS.dAray[s].l+gdS.dAray[s].w;var a=gdS.dAray[s].l<e+n&&e+n<gdS.dAray[s].l+gdS.dAray[s].w;if(!(u||a)){return}var f=gdS.dAray.length-1;while(f>=0){if(gdS.dAray[f].node.hy==gdS.node.hy){break}f--}var l=gdS.node.hy;gdS.node.hy=gdS.dAray[s].node.hy;gdS.dAray[s].node.hy=l;gdS.dAray[s].node.style.top=l+"px";var c=gdS.dAray[s].l;gdS.dAray[s].l=gdS.dAray[f].l;gdS.dAray[f].l=c;c=gdS.dAray[s].t;gdS.dAray[s].t=gdS.dAray[f].t;gdS.dAray[f].t=c;c=gdS.dAray[s].h;gdS.dAray[s].h=gdS.dAray[f].h;gdS.dAray[f].h=c;c=gdS.dAray[s].w;gdS.dAray[s].w=gdS.dAray[f].w;gdS.dAray[f].w=c}function s(){function o(e){var t=parseInt(gdS.node.style.left);var n=t+parseInt(gdS.node.style.width);var r=parseInt(e.style.left);var i=r+parseInt(e.style.width);if(r<t&&i>t){return true}if(r<n&&i>n){return true}return false}var e=parseInt(gdS.node.style.top);e+=parseInt(gdS.node.style.height)/2;var t;for(var n=0;n<larrayOfDivs.length;n++){t=larrayOfDivs[n].hy;if(e>=t&&e<=t+parseInt(larrayOfDivs[n].style.height)){if(larrayOfDivs[n].c!=0){break}if(o(larrayOfDivs[n])){qSC.clip(larrayOfDivs[n],gdS.node)}break}}i(parseInt(gdS.node.style.left),parseInt(gdS.node.style.top));gdS.node.style.top=gdS.node.hy+"px";if(gdS.node.c==0)gdS.node.style.left=gdS.node.hx+"px";if(gd==1){document.removeEventListener("touchmove",r,true);document.removeEventListener("touchend",s,true)}else{document.removeEventListener("mousemove",r,true);document.removeEventListener("mouseup",s,true)}gdS.node.style.opacity=1;gdS.node.style.webkitTransform="scale(1)";gdS.node.style.MozTransform="scale(1)";gdS.node.style.OTransform="scale(1)";gdS.node.style.msTransform="scale(1)";gdS.node.style.zIndex=0}this.initQuestionStruct=function(){var e=gv.q.info.split("|");for(var t=0;t<e.length;t++){gv.q.sAray[t]=QH.LoadQuestionStruct(t)}};this.initQuestionSlide=function(){var e=anima["s"+gc].q,t;if(e[0]==0){var r=qSC.HandleUnattendedQuestions();if(r>0){return r}else{if(gv.s!=0){objDopPhSco.End()}}if(qSC.modifyResultSlide(gc)){qSC.updateXmlAtEnd()}gv.q.cmpltd=true;if(typeof Player!="undefined"){if(typeof Player.sndFdBk!="undefined"){Player.sndFdBk()}}return false}qSC.modifySlideAtInit(e);var i;if(e[4]!=null||gv.q.cmpltd){t=gv.o("s"+gc+"s"+e[3]);t.onclick=null;t.onmousedown=null;t.onmouseover=null;t.onmouseout=null;t.style.cursor="default";t.style.opacity=0;for(i=0;i<e[2].length;i++){if(typeof e[2][i]=="object"){for(var s=0;s<e[2][i].length;s++){t=gv.o("s"+gc+"s"+e[2][i][s]);t.style.cursor="default";if(gd==1){t.ontouchstart=null;t.ontouchmove=null;t.ontouchend=null}else{t.onmousedown=null;t.onclick=null;t.onmouseover=null;t.onmouseout=null}}return false}t=gv.o("s"+gc+"s"+e[2][i]);if(gd==1){t.ontouchstart=null;t.ontouchmove=null;t.ontouchend=null}else{t.onmouseover=null;t.onmouseout=null;t.onclick=null;t.onmousedown=null}t.style.cursor="default"}return false}if(arrayOfDivs.length>0){arrayOfDivs.splice(0,arrayOfDivs.length)}if(larrayOfDivs.length>0){larrayOfDivs.splice(0,larrayOfDivs.length)}if(e[3]!=null){t=gv.o("s"+gc+"s"+e[3]);t.style.cursor="pointer";t.onmouseover=function(){RListener(this)};t.onmouseout=function(){AListener(this)};t.onclick=function(){qsh.sb()}}for(i=0;i<e[2].length;i++){if(typeof e[2][i]=="object")continue;t=gv.o("s"+gc+"s"+e[2][i]);if(typeof t.c=="undefined"){t.hy=parseInt(t.style.top);t.hx=parseInt(t.style.left);t.c=0;t.onmouseover=function(){RListener(this)};t.onmouseout=function(){AListener(this)};t.style.cursor="pointer";if(e[0]!=4&&e[0]!=5){qSC.checkUncheckOrder(t,e[0],0,"")}}if(e[0]==1||e[0]==2){t.onclick=function(){for(var e=0;e<arrayOfDivs.length;e++){arrayOfDivs[e].c=0;qSC.checkUncheckOrder(arrayOfDivs[e],1,0,"")}this.c=1;qSC.checkUncheckOrder(this,1,1,"")}}else if(e[0]==3){t.onclick=function(){if(this.c==0){this.c=1;qSC.checkUncheckOrder(this,3,1,"")}else{this.c=0;qSC.checkUncheckOrder(this,3,0,"")}}}else if(e[0]==4||e[0]==5){if(gd==1){t.ontouchstart=function(){n(event,this)}}else{t.onmousedown=function(){n(arguments[0]||event,this)}}if(larrayOfDivs.length==0&&e[0]==5){for(var o=0;o<e[2][e[2].length-1].length;o++){var u=gv.o("s"+gc+"s"+e[2][e[2].length-1][o]);if(typeof u.c=="undefined"){u.hy=parseInt(u.style.top);u.hx=parseInt(u.style.left);u.c=0}larrayOfDivs.push(u)}}}arrayOfDivs.push(t)}};this.sb=function(){var n,r;var i=anima["s"+gc].q;var s=i[2];var o=e(i,arrayOfDivs);if(!o){return}for(r=0;r<arrayOfDivs.length;r++){n=arrayOfDivs[r].id.split("s");n=parseInt(n[n.length-1]);n=s.indexOf(n);gv.q.sAray[i[1]-1].Answers[n]=arrayOfDivs[r].c}QH.SubmitAnswer(gv.q.sAray[i[1]-1]);qSC.updateAnsXml(gc);var u=QH.GetResult();if(u.qnsAtnd==u.tQns){gv.q.cmpltd=true}if(gv.s!=0){objDopPhSco.Submit()}if(QH.GetStatus(i[1]-1)=="b"){t(1)}else{t(2)}}};qsh=new QuestionHandler;QuizSupportClass=function(){function e(e,t,n){var r=t.slice(0);if(typeof r[r.length-1]=="object"){r.pop()}r.sort(function(t,n){return parseInt(gv.o("s"+e+"s"+t).style.top)-parseInt(gv.o("s"+e+"s"+n).style.top)});for(var i=0;i<n.length;i++){r[i]=gv.o("s"+e+"s"+r[i]).style.top}var s;for(i=0;i<n.length;i++){s=n.indexOf(i);gv.o("s"+e+"s"+t[s]).style.top=r[i]}}function t(e){function l(e,t,n){var r=document.createElement("div");var i=parseInt(e.style.left)-30;if(n==4){i=parseInt(e.style.left)-70}r.setAttribute("style","height:24px;width:24px;top:"+(parseInt(e.style.top)+(parseInt(e.style.height)-22)/2)+"px;left:"+i+"px;");var s=document.createElement("img");if(t==0){s.setAttribute("src",gv.d+"player/cross.png")}else{s.setAttribute("src",gv.d+"player/tick.png")}r.appendChild(s);var o=e.parentNode;o.appendChild(r)}var t=anima["s"+e].q;if(!gv.q.sRv){return}var n=t[2];var r=t[1];var i=t[0];var s=(new Question(r-1,"a")).Answers;var o=gv.q.sAray[r-1].Answers;var u=gv.q.sAray[r-1].Status;var a;for(var f=0;f<n.length;f++){a=gv.o("s"+e+"s"+n[f]);switch(i){case 1:case 2:case 3:if(s[f]==1){l(a,1,i)}break;case 4:if(s[f]==o[f]){if(u=="a"){l(a,0,i)}else{l(a,1,i)}}else{l(a,0,i)}break;case 5:if(a==null){break}a=gv.o("s"+e+"s"+n[n.length-1][f]);if(s[f]==o[f]){if(u=="a"){l(a,0,i)}else{l(a,1,i)}}else{l(a,0,i)}break}}}this.loadXmlFrmTxt=function(e){if(window.ActiveXObject){var t=new ActiveXObject("Microsoft.XMLDOM");t.async=false;t.loadXML(e);gv.q.zXml=t}else{var n=new DOMParser;gv.q.zXml=n.parseFromString(e,"text/xml")}var r=gv.q.zXml.getElementsByTagName("Track")[0];var i;try{i=r.attributes.getNamedItem("cmpltd").value}catch(s){i="false";r.setAttribute("cmpltd",i)}if(i=="true"){gv.q.cmpltd=true}else{gv.q.cmpltd=false}};this.loadQuizFromXml=function(){function c(e,t){var n=new Array;for(var r=0;r<e.length;r++){n.push(e[r])}n.sort(function(e,t){return parseInt(e.getAttribute("NewPos_y"))-parseInt(t.getAttribute("NewPos_y"))});return n.indexOf(t)}if(gv.q.zXml==""){return}var e=gv.q.info.split("|");var t=gv.q.zXml.getElementsByTagName("Track")[0];var n=t.getElementsByTagName("Question");var r=t.attributes.getNamedItem("status").value;if(r==="nc"||r==="sd"){gv.q.cmpltd=false}else{gv.q.cmpltd=true}var i=0;for(var s=0;s<n.length;s++){if(n[s].attributes.getNamedItem("Flag").value==="Passed"){i+=gv.q.sAray[s].Score}var o=n[s].getElementsByTagName("Answer");if(o.length>0){var u=e[s];var a=parseInt(u.substring(8,9));var f=u.substring(10,u.length);f=f.split("");for(var l=0;l<o.length;l++){if(a==0||a==1||a==2){gv.q.sAray[s].Answers[l]=o[l].getAttribute("Flag")=="Passed"?parseInt(f[l]):parseInt(f[l])==0?1:0}else{gv.q.sAray[s].Answers[l]=c(o,o[l])}}QH.SubmitAnswer(gv.q.sAray[s])}else{if(n[s].attributes.getNamedItem("Flag").value=="Failed"){QH.SubmitAnswer(gv.q.sAray[s])}}}t.setAttribute("score",i)};this.modifySlideAtInit=function(n){var r=n[1];var i=n[0];var s=gv.q.sAray[r-1];if(!gv.q.cmpltd&&s.Status=="a"||i==0||n[4]==0){return}n[4]=0;var o=n[2];var u=s.Answers;var a=(new Question(r-1,"a")).Answers;var f;if(i==4||i==5){if(s.Status!="a"){e(gc,o,u)}}for(var l=0;l<u.length;l++){if(typeof o[l]=="object"){continue}f=gv.o("s"+gc+"s"+o[l]);switch(i){case 1:case 2:case 3:if(s.Status=="a"){qSC.checkUncheckOrder(f,i,0,"")}else{if(!gv.q.sRv){if(u[l]==1){qSC.checkUncheckOrder(f,i,1,"")}else{qSC.checkUncheckOrder(f,i,0,"")}break}if(u[l]==a[l]){if(a[l]==1){qSC.checkUncheckOrder(f,i,u[l],"g")}else{qSC.checkUncheckOrder(f,i,a[l],"")}}else{qSC.checkUncheckOrder(f,i,u[l],"r")}}break;case 4:if(!gv.q.sRv){break}if(s.Status=="a"){qSC.checkUncheckOrder(f,i,a[l]+1,"red")}else{if(u[l]==a[l]){qSC.checkUncheckOrder(f,i,u[l]+1,"green")}else{qSC.checkUncheckOrder(f,i,a[l]+1,"red")}}break;case 5:if(s.Status=="a"){if(gv.q.sRv){qSC.checkUncheckOrder(f,i,a[l]+1,"red")}}else{var c=o[o.length-1];qSC.clip(gv.o("s"+gc+"s"+c[l]),f);if(gv.q.sRv){if(u[l]==a[l]){qSC.checkUncheckOrder(f,i,u[l]+1,"green")}else{qSC.checkUncheckOrder(f,i,a[l]+1,"red")}}}break}}t(gc)};this.updateAnsXml=function(e){if(gv.q.zXml==""){return}var t=anima["s"+e].q;var n=t[2];var r=t[1];var i=new Question(r-1,"a");var s=gv.q.sAray[r-1].Status==="b"?"Passed":"Failed";var o=gv.q.zXml.createElement("Question");o.setAttribute("Index",r);o.setAttribute("Flag",s);for(var u=0;u<i.Answers.length;u++){var a=gv.q.zXml.createElement("Answer");if(i.Answers[u]===gv.q.sAray[r-1].Answers[u]){a.setAttribute("Flag","Passed")}else{a.setAttribute("Flag","Failed")}a.setAttribute("NewPos_y",parseInt(gv.o("s"+e+"s"+n[u]).style.top));o.appendChild(a)}var f=gv.q.zXml.getElementsByTagName("Track")[0];f.setAttribute("time",zenler.GetTime(selectedContentIndex));f.setAttribute("currentpageIndex",gc);f.setAttribute("currentquestionindex",r);var l=parseFloat(f.attributes.getNamedItem("score").value);if(s==="Passed"){l+=gv.q.sAray[r-1].Score}f.setAttribute("score",l);f.setAttribute("status","sd");var c=f.getElementsByTagName("Question")[r-1];f.replaceChild(o,c);var h;var p=gv.q.zXml;if(window.ActiveXObject){h=p.xml}else{h=(new XMLSerializer).serializeToString(p)}zenler.UpdateNodeContent(h)};this.updateXmlAtEnd=function(){if(gv.q.zXml===""){return}var e=gv.q.zXml.getElementsByTagName("Track")[0];e.setAttribute("currentpageIndex",gc);e.setAttribute("currentquestionindex",e.parentNode.attributes.getNamedItem("questioncount").value);var t=QH.GetResult();if(t.Status){e.setAttribute("status","pd")}else{e.setAttribute("status","fd")}var n;if(window.ActiveXObject){var r=gv.q.zXml;n=r.xml}else{n=(new XMLSerializer).serializeToString(gv.q.zXml)}zenler.UpdateNodeContent(n)};this.modifyResultSlide=function(e){function i(e,t){e=gv.o("s"+gc+"s"+e);if(e!=null){var n=e.getElementsByTagName("pre");if(n.length>0){n[n.length-1].innerHTML+=" : "+t}else{var r=document.createElement("pre");var i=parseInt(e.style.height);r.setAttribute("style","left:"+e.style.width+";top:"+i/4+"px;font-weight:bold;");r.innerHTML=" : "+t;e.appendChild(r)}}}function s(e,t){var n,r="s"+gc+"s"+e,i=1,s=new Array;n=gv.o(r);if(n){n.style.display=t}while(gv.o(r+"p"+i)!=null){s[s.length]=gv.o(r+"p"+i);i++}for(i=0;i<s.length;i++){if(s[i]){s[i].style.display=t}}}var t=anima["s"+e].q;if(t[4]!=null){return false}var n=QH.GetResult(),r=t[1];i(r[0],n.tQns);i(r[1],n.tScore);i(r[2],n.pRate+" %");i(r[3],n.qnsAtnd);i(r[4],n.cAnswrs);i(r[5],n.wAnswrs);i(r[6],n.yScore);if(r[8]!=null&&gv.o("s"+gc+"s"+r[7])!=null){if(n.Status){s(r[7],"block");s(r[8],"none")}else{s(r[7],"none");s(r[8],"block")}}t[4]=0;return true};this.HandleUnattendedQuestions=function(){function n(e){for(var t=1;t<gv.t;t++){var n=anima["s"+t];n=n.q;if(typeof n=="undefined")continue;if(n[1]==e){return t}}return 0}if(gv.q.cmpltd){return 0}if(anima["s"+gv.t].q[5]==1){return 0}for(var e=0;e<gv.q.sAray.length;e++){if(gv.q.sAray[e].Status=="a"){var t=function(){this.yes=function(){anima["s"+gv.t].q[5]=0};this.no=function(){anima["s"+gv.t].q[5]=1;ncc.z(gv.t)}};Player.ShowMsg('You have not attended one or more questions.\n\nClick "Yes" to attend remaining questions. \nClick "No" to finish the quiz without attending the remaining questions.',"Zenler","yesno",new t);return n(gv.q.sAray[e].Index)}}return 0};this.checkUncheckOrder=function(e,t,n,r){var i=e.getElementsByTagName("div");var s=null;for(var o=0;o<i.length;o++){if(i[o].id.indexOf("qc")>0){s=i[o];break}}if(s==null){s=qSC.addDiv(e,e.id+"qc",0,0,t)}s.className="";switch(t){case 1:case 2:if(n==1){s.className="DOPrOn"+r}else{s.className="DOPrOff"+r}break;case 3:if(n==1){s.className="DOPtOn"+r}else{s.className="DOPtOff"+r}break;case 4:if(n<0){break}a=parseInt(e.style.height);var u;if(s.innerHTML.trim(" ")==""){u=qSC.addPre(s,n,a)}else{u=s.getElementsByTagName("pre")[0]}u.style.color=r;s.style.left="20px";break;case 5:if(n<0){break}var a=parseInt(e.style.height);var f;if(s.innerHTML.trim(" ")==""){f=qSC.addPre(s,n,a)}else{f=s.getElementsByTagName("pre")[0]}f.style.color=r;s.style.left="45px";break}};this.addDiv=function(e,t,n,r,i){var s=document.createElement("div");if(i==4||i==5){s.setAttribute("style","top:"+n+"px;left:"+r+"px;")}s.setAttribute("id",t);e.appendChild(s);return s};this.addPre=function(e,t,n){var r=document.createElement("pre");r.setAttribute("style","font-size:20px;font-family:tahoma;font-weight:bold;");r.innerHTML=t;e.appendChild(r);r.style.top=(n-24)/2+"px";return r};this.clip=function(e,t){var n=typeof e.hx==="undefined"?e.style.left:e.hx;n=parseInt(n);var r=parseInt(e.style.width);var i=parseInt(typeof t.hx==="undefined"?t.style.left:t.hx);var s=parseInt(t.style.width);var o=n+(i+s-n)/2;var u=s-r;e.style.left=o-r+"px";t.style.left=o-u-10+"px";e.c=t.id;t.c=e.id};this.unclip=function(e){if(e.c==0){return}var t=gv.o(e.c);e.c=0;t.c=0;e.style.left=e.hx+"px";t.style.left=t.hx+"px"};this.findPos=function(e){var t=0,n=0;if(e.offsetParent)do{t+=e.offsetLeft;n+=e.offsetTop}while(e=e.offsetParent);return[t,n]}};qSC=new QuizSupportClass;QuizHandler=function(){this.LoadQuestionStruct=function(e){var t=new Question(e,"s");return t};this.GetStatus=function(e){var t=-1;if(null!=gv.q.sAray[e]){t=gv.q.sAray[e].Status}return t};this.SubmitAnswer=function(e){e.Status="b";var t=e.Index-1;var n=new Question(t,"a");for(var r=0;r<n.Answers.length;r++){if(n.Answers[r]!=e.Answers[r]){e.Status="c";break}}gv.q.sAray[t]=e};this.GetResult=function(){var e=gv.q.sAray.length;var t=0;var n=0;var r=0;var i=0;for(var s=0;s<e;s++){var o=gv.q.sAray[s];t+=o.Score;if(o.Status=="b"){n++;i+=o.Score}else if(o.Status=="c"){r++}}var u=n+r;var a=i/t*100>=gv.q.psRate;var f={Status:a,tQns:e,tScore:t,pRate:gv.q.psRate,qnsAtnd:u,cAnswrs:n,wAnswrs:r,yScore:i};return f}};Question=function(e,t){var n=gv.q.info.split("|");var r=n[e];this.Index=parseInt(r.substring(0,3));this.Score=parseFloat(r.substring(3,8));this.Type=parseInt(r.substring(8,9));this.Status="a";this.Answers=new Array;for(var i=0,s=10;s<r.length;s++,i++){this.Answers[i]=t=="s"?0:parseInt(r.substring(s,s+1),16)}};var QH=new QuizHandler;var DopPhSco=function(e){var t;this.scormendStatus=false;var n;var r=function(){function e(){n=new s;if(gv.q==0){i.Load()}else{o.Load()}window.onunload=r.onUnload}var r=function(){function e(){t=(new Date).getTime()}function i(){if(gv.t===gc){return}n.doLMSSetValue("cmi.core.exit","suspend");s()}function s(){r.GetTime();n.doLMSCommit();n.doLMSFinish()}function o(){if(t!=0){var e=(new Date).getTime();var r=(e-t)/1e3;var i=u(r)}else{i="00:00:00.0"}n.doLMSSetValue("cmi.core.session_time",i)}function u(e){var t=e%60;e-=t;var n=e%3600;e-=n;t=Math.round(t*100)/100;var r=new String(t);var i=r;var s="";if(r.indexOf(".")!=-1){i=r.substring(0,r.indexOf("."));s=r.substring(r.indexOf(".")+1,r.length)}if(i.length<2){i="0"+i}r=i;if(s.length){r=r+"."+s}var o;if(e%3600!=0){o=0}else{o=e/3600}var u;if(n%60!=0){u=0}else{u=n/60}if((new String(o)).length<2){o="0"+o}if((new String(u)).length<2){u="0"+u}var a=o+":"+u+":"+r;return a}return{InitiateTimer:e,GetTime:o,onUnload:i,Quit:s}}();var i=function(){function e(){n.doLMSInitialize();var e=n.doLMSGetValue("cmi.core.lesson_status");var i=n.doLMSGetValue("cmi.core.lesson_location");if(i==""||i==null){i=1;t(1,gv.t)}scormGoTo(i);if(e=="completed"||e=="passed"){this.scormendStatus=true}else{n.doLMSSetValue("cmi.core.lesson_status","incomplete")}r.InitiateTimer();n.doLMSCommit();t(i,gv.t)}function t(e,t){if(!this.scormendStatus){n.doLMSSetValue("cmi.core.lesson_location",e);var r=e/t*100;r=Math.round(r*100)/100;n.doLMSSetValue("cmi.core.score.raw",r);var s;if(r==100){s="completed"}else{s="incomplete"}i(s);n.doLMSCommit()}}function i(e){n.doLMSSetValue("cmi.core.lesson_status",e);if(e=="completed"){e="passed";n.doLMSSetValue("cmi.core.lesson_status",e)}}return{Load:e,UpdateLesson:t}}();var o=function(){function e(){n.doLMSInitialize();var e=n.doLMSGetValue("cmi.core.lesson_location");if(e==null||e==""){e=1}scormGoTo(e);n.doLMSSetValue("cmi.core.lesson_location",e);var t=n.doLMSGetValue("cmi.core.lesson_status");if(t=="failed"||t=="passed"||t=="completed"){t="completed"}else{t="incomplete";n.doLMSSetValue("cmi.core.lesson_status",t)}if(t=="incomplete"){gv.q.cmpltd=false}else{gv.q.cmpltd=true}var i=n.doLMSGetValue("cmi.suspend_data");if(i==""||i==null){qsh.initQuestionStruct();i=s(gv.q.sAray);n.doLMSSetValue("cmi.suspend_data",i)}else{gv.q.sAray=o(i)}var u=QH.GetResult();if(u.Status){gv.q.pasd=true}else{gv.q.pasd=false}n.doLMSCommit();r.InitiateTimer()}function t(){var e=QH.GetResult();var t=e.yScore/e.tScore*100;t=Math.round(t*100)/100;n.doLMSSetValue("cmi.core.score.raw",t);var r=s(gv.q.sAray);n.doLMSSetValue("cmi.suspend_data",r);n.doLMSSetValue("cmi.core.lesson_location",gc);if(e.tQns==e.qnsAtnd){gv.q.cmpltd=true}var i;if(gv.q.cmpltd){i="completed"}else{i="incomplete"}n.doLMSSetValue("cmi.core.lesson_status",i);var o;if(e.Status){o="passed";n.doLMSSetValue("cmi.core.lesson_status",o)}else{if(gv.q.cmpltd){o="failed";n.doLMSSetValue("cmi.core.lesson_status",o)}}n.doLMSCommit()}function i(){var e;var t=QH.GetResult();if(t.Status){e="passed"}else{e="failed"}var r=t.yScore/t.tScore*100;r=Math.round(r*100)/100;n.doLMSSetValue("cmi.core.score.raw",r);n.doLMSSetValue("cmi.core.lesson_status",e);n.doLMSCommit()}function s(e){var t="";for(var n=0;n<e.length;n++){t+=u(e[n].Index,3)+a(e[n].Score)+e[n].Status+e[n].Type+e[n].Answers.length;for(var r=0;r<e[n].Answers.length;r++){t+=e[n].Answers[r]}t+="|"}return t.substring(0,t.length-1)}function o(e){var t=e.split("|");var n=new Array;for(var r=0;r<t.length;r++){n[r]=new f(t[r])}return n}function u(e,t){e+="";while(e.length<t){e="0"+e}return e}function a(e){e=e.toFixed(2);e=u(e,5);return e}var f=function(e){this.Index=parseInt(e.substring(0,3));this.Score=parseFloat(e.substring(3,8));this.Status=e.substring(8,9);this.Type=parseInt(e.substring(9,10));e=e.substring(11,e.length);this.Answers=e.split("");for(var t=0;t<this.Answers.length;t++){this.Answers[t]=parseInt(this.Answers[t])}};return{createString:s,createArray:o,Load:e,Submit:t,End:i}}();return{Load:e,Quit:r.Quit,UpdateLesson:i.UpdateLesson,End:o.End,Submit:o.Submit}};var i=function(){function e(){n=new o;if(gv.q==0){i.Load()}else{s.Load()}window.onunload=r.onUnload}var r=function(){function e(){t=(new Date).getTime()}function i(){if(gv.t===gc){return}n.doSetValue("cmi.exit","suspend");s()}function s(){r.GetTime();n.doCommit();n.doTerminate()}function o(){if(t!=0){var e=(new Date).getTime();var r=(e-t)/1e3;var i=u(r)}else{i="PT00H00M00S"}n.doSetValue("cmi.session_time",i)}function u(e){var t=e%60;e-=t;var n=e%3600;e-=n;t=Math.round(t*100)/100;var r=new String(t);var i=r;var s="";if(r.indexOf(".")!=-1){i=r.substring(0,r.indexOf("."));s=r.substring(r.indexOf(".")+1,r.length)}if(i.length<2){i="0"+i}r=i;if(s.length){r=r+"."+s}var o;if(e%3600!=0){o=0}else o=e/3600;var u;if(n%60!=0){u=0}else{u=n/60}if((new String(o)).length<2){o="0"+o}if((new String(u)).length<2){u="0"+u}var a="PT"+o+"H"+u+"M"+r+"S";return a}return{InitiateTimer:e,GetTime:o,onUnload:i,Quit:s}}();var i=function(){function e(){n.doInitialize();var e=n.doGetValue("cmi.completion_status");var i=n.doGetValue("cmi.location");if(i==""||i==null){i=1;t(1,gv.t)}scormGoTo(i);if(e=="completed"){this.scormendStatus=true}else{n.doSetValue("cmi.completion_status","incomplete")}r.InitiateTimer();n.doCommit();t(i,gv.t)}function t(e,t){if(!this.scormendStatus){n.doSetValue("cmi.location",e);var r=e/t*100;i(r);var o;if(r==100){o="completed"}else{o="incomplete"}s(o);n.doCommit()}}function i(e){n.doSetValue("cmi.score.min",0);n.doSetValue("cmi.score.max",100);n.doSetValue("cmi.score.raw",e);n.doSetValue("cmi.score.scaled",e/100);n.doSetValue("cmi.progress_measure",e/100)}function s(e){n.doSetValue("cmi.completion_status",e);if(e=="completed"){e="passed"}else{e="failed"}n.doSetValue("cmi.success_status",e)}return{Load:e,UpdateLesson:t}}();var s=function(){function e(){n.doInitialize();var e=n.doGetValue("cmi.location");if(e==null||e==""){e=1}scormGoTo(e);n.doSetValue("cmi.location",e);var t=n.doGetValue("cmi.completion_status");if(t=="not_attempted"||t=="unknown"||t==""){t="incomplete";n.doSetValue("cmi.completion_status",t)}if(t=="incomplete"){gv.q.cmpltd=false}else{gv.q.cmpltd=true}var i=n.doGetValue("cmi.suspend_data");if(i==""||i==null){qsh.initQuestionStruct();i=s(gv.q.sAray);n.doSetValue("cmi.suspend_data",i)}else{gv.q.sAray=o(i)}if(t!="completed"&&gc==gv.t){n.doSetValue("cmi.completion_status","completed")}var u=n.doGetValue("cmi.success_status");if(u=="passed"){gv.q.pasd=true}else{gv.q.pasd=false}n.doCommit();r.InitiateTimer()}function t(){var e=QH.GetResult();var t=e.yScore;var i=e.yScore/e.tScore;n.doSetValue("cmi.score.min",0);n.doSetValue("cmi.score.max",e.tScore);n.doSetValue("cmi.score.raw",t);n.doSetValue("cmi.score.scaled",i);var o=s(gv.q.sAray);n.doSetValue("cmi.suspend_data",o);n.doSetValue("cmi.location",gc);if(e.tQns==e.qnsAtnd){gv.q.cmpltd=true}var u;if(gv.q.cmpltd){u="completed"}else{u="incomplete"}n.doSetValue("cmi.completion_status",u);var a;if(e.Status){a="passed"}else{if(gv.q.cmpltd){a="failed"}else{a="unknown"}}n.doSetValue("cmi.success_status",a);n.doCommit();if(gv.q.cmpltd){r.Quit()}}function i(){var e=QH.GetResult();var t=e.yScore;var i=e.yScore/e.tScore;n.doSetValue("cmi.score.min",0);n.doSetValue("cmi.score.max",e.tScore);n.doSetValue("cmi.score.raw",t);n.doSetValue("cmi.score.scaled",i);n.doSetValue("cmi.location",gc);var s="completed";n.doSetValue("cmi.completion_status",s);var o;if(e.Status){o="passed"}else{o="failed"}n.doSetValue("cmi.success_status",o);n.doCommit();r.Quit()}function s(e){var t="";for(var n=0;n<e.length;n++){t+=u(e[n].Index,3)+a(e[n].Score)+e[n].Status+e[n].Type+e[n].Answers.length;for(var r=0;r<e[n].Answers.length;r++){t+=e[n].Answers[r]}t+="|"}return t.substring(0,t.length-1)}function o(e){var t=e.split("|");var n=new Array;for(var r=0;r<t.length;r++){n[r]=new f(t[r])}return n}function u(e,t){e+="";while(e.length<t){e="0"+e}return e}function a(e){e=e.toFixed(2);e=u(e,5);return e}var f=function(e){this.Index=parseInt(e.substring(0,3));this.Score=parseFloat(e.substring(3,8));this.Status=e.substring(8,9);this.Type=parseInt(e.substring(9,10));e=e.substring(11,e.length);this.Answers=e.split("");for(var t=0;t<this.Answers.length;t++)this.Answers[t]=parseInt(this.Answers[t])};return{createString:s,createArray:o,Load:e,Submit:t,End:i}}();return{Load:e,Quit:r.Quit,UpdateLesson:i.UpdateLesson,End:s.End,Submit:s.Submit}};var s=function(){function i(){var e=d();if(e==null){alert("Unable to locate the LMS's API Implementation.\nLMSInitialize was not successful.");return"false"}var t=e.LMSInitialize("");if(t.toString()!="true"){p()}else{}return t.toString()}function s(){var e=d();if(e==null){alert("Unable to locate the LMS's API Implementation.\nLMSFinish was not successful.");return"false"}else{var t=e.LMSFinish("");if(t.toString()!="true"){p()}else{}}return t.toString()}function o(e){var n=d();if(n==null){alert("Unable to locate the LMS's API Implementation.\nLMSGetValue was not successful.");return""}else{var r=n.LMSGetValue(e);var i=n.LMSGetLastError().toString();if(i!=t._NoError){var s=n.LMSGetErrorString(i);alert("LMSGetValue("+e+") failed. \n"+s);return""}else{return r.toString()}}}function u(e,t){var n=d();if(n==null){alert("Unable to locate the LMS's API Implementation.\nLMSSetValue was not successful.");return}else{var r=n.LMSSetValue(e,t);if(r.toString()!="true"){p()}}return}function a(){var e=d();if(e==null){alert("Unable to locate the LMS's API Implementation.\nLMSCommit was not successful.");return"false"}else{var t=e.LMSCommit("");if(t!="true"){p()}}return t.toString()}function f(){var e=d();if(e==null){alert("Unable to locate the LMS's API Implementation.\nLMSGetLastError was not successful.")}return e.LMSGetLastError().toString()}function l(e){var t=d();if(t==null){alert("Unable to locate the LMS's API Implementation.\nLMSGetErrorString was not successful.")}return t.LMSGetErrorString(e).toString()}function c(e){var t=d();if(t==null){alert("Unable to locate the LMS's API Implementation.\nLMSGetDiagnostic was not successful.")}return t.LMSGetDiagnostic(e).toString()}function h(){var e=d();if(e==null){alert("Unable to locate the LMS's API Implementation.\nLMSIsInitialized() failed.");return false}else{e.LMSGetValue("cmi.core.student_name");var n=e.LMSGetLastError().toString();if(n==t._NotInitialized){return false}else{return true}}}function p(){var n=d();if(n==null){alert("Unable to locate the LMS's API Implementation.\nCannot determine LMS error code.");return null}var r=n.LMSGetLastError().toString();if(r!=t._NoError){var i=n.LMSGetErrorString(r);if(e==true){i+="\n";i+=n.LMSGetDiagnostic(null)}alert(i)}return r}function d(){if(n==null){n=m()}return n}function v(e){while(e.API==null&&e.parent!=null&&e.parent!=e){r++;if(r>7){alert("Error finding API -- too deeply nested.");return null}e=e.parent}return e.API}function m(){var e=v(window);if(e==null&&window.opener!=null&&typeof window.opener!="undefined"){e=v(window.opener)}if(e==null){alert("Unable to find an API adapter")}return e}var e=false;var t={_NoError:0,_NotInitialized:301};var n=null;var r=0;return{doLMSFinish:s,doLMSInitialize:i,doLMSGetValue:o,doLMSSetValue:u,doLMSCommit:a,doLMSGetLastError:f,doLMSGetErrorString:l,doLMSGetDiagnostic:c,LMSIsInitialized:h}};var o=function(){function r(){var e=p();if(e==null){alert("Unable to locate the LMS's API Implementation.\nInitialize was not successful.");return"false"}var t=e.Initialize("");if(t.toString()!="true"){h()}return t.toString()}function i(){var e=p();if(e==null){alert("Unable to locate the LMS's API Implementation.\nTerminate was not successful.");return"false"}else{var t=e.Terminate("");if(t.toString()!="true"){h()}}return t.toString()}function s(e){var n=p();if(n==null){alert("Unable to locate the LMS's API Implementation.\nGetValue was not successful.");return""}else{var r=n.GetValue(e);var i=n.GetLastError().toString();if(i!=t._NoError){return""}else{return r.toString()}}}function o(e,t){var n=p();if(n==null){alert("Unable to locate the LMS's API Implementation.\nSetValue was not successful.");return null}else{var r=n.SetValue(e,t);if(r.toString()!="true"){var i=h();r=i}}return r}function u(){var e=p();if(e==null){alert("Unable to locate the LMS's API Implementation.\nCommit was not successful.");return"false"}else{var t=e.Commit("");if(t!="true"){h()}}return t.toString()}function a(){var e=p();if(e==null){alert("Unable to locate the LMS's API Implementation.\nGetLastError was not successful.");return null}return e.GetLastError().toString()}function f(e){var t=p();if(t==null){alert("Unable to locate the LMS's API Implementation.\nGetErrorString was not successful.")}return t.GetErrorString(e).toString()}function l(e){var t=p();if(t==null){alert("Unable to locate the LMS's API Implementation.\nGetDiagnostic was not successful.")}return t.GetDiagnostic(e).toString()}function c(){var e=p();if(e==null){alert("Unable to locate the LMS's API Implementation.\nlmsIsInitialized() failed.");return false}else{e.GetValue("cmi.core.student_name");var t=e.GetLastError().toString();if(t==_NotInitialized){return false}else{return true}}}function h(){var n=p();if(n==null){alert("Unable to locate the LMS's API Implementation.\nCannot determine LMS error code.");return null}var r=n.GetLastError().toString();if(r!=t._NoError){var i=n.GetErrorString(r);if(e==true){i+="\n";i+=n.GetDiagnostic(null)}alert(i)}return r}function p(){if(n==null){n=m()}return n}function v(e){var t=0;while(e.API_1484_11==null&&e.parent!=null&&e.parent!=e&&t<=d){t++;e=e.parent}return e.API_1484_11}function m(){var e=null;if(window.parent!=null&&window.parent!=window){e=v(window.parent)}if(e==null&&window.top.opener!=null){e=v(window.top.opener)}return e}var e=false;var t={_NoError:0};var n=null;var d=500;return{doInitialize:r,doTerminate:i,doGetValue:s,doSetValue:o,doCommit:u,doGetLastError:a,doGetErrorString:f,doGetDiagnostic:l,LMSIsInitialized:c}};if(e=="2004"){return new i}else{return new r}}