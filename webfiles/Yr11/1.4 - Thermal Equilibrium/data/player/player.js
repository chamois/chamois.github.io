//Version 1.0.2
function loadNewPres(){loading.LoadingStart();if(isTouchDevice){if(navigator.userAgent.match(/iPad/i)){window.orc=0;window.onorientationchange=function(){if(ipadKeyPadFlg==1){this.orc=1}};if(top===self){window.scrollTo(0,1);document.getElementById("statusCurrent").onfocus=function(){ipadKeyPadFlg=1};document.getElementById("statusCurrent").onblur=function(){ipadKeyPadFlg=0}}}}document.getElementById("toolbar").style.backgroundColor="#ECECEC";document.getElementById("toolbar").style.borderTop="1px solid #DBDADA";document.getElementsByTagName("body")[0].style.backgroundColor=presSettings.BackColr;var e=document.getElementById("resizer");e.style.height=presSettings.Height+"px";e.style.width=presSettings.Width+"px";pcc.r();window.onresize=pcc.r;var t=document.getElementById("time");t.innerHTML="";var n=document.createElement("span");n.setAttribute("style","font-weight: bold; color: #525151;");n.id="times";t.appendChild(n);var r=Math.floor(presSettings.TotalTime/1e3%60);var i=Math.floor(presSettings.TotalTime/1e3/60%60);var s=Math.floor(presSettings.TotalTime/1e3/60/60%24);if(r<10)r="0"+r;if(i<10)i="0"+i;if(s<10)s="0"+s;if(s==0){t.innerHTML=t.innerHTML+":"+i+":"+r}else{t.innerHTML=t.innerHTML+":"+s+":"+i+":"+r}document.getElementById("buttonDiv").style.display="block";document.getElementById("progressContainer").style.display="block";document.getElementById("time").style.display="block";document.getElementById("status").style.display="block";if(presSettings.Notes["s"+0]!=0){document.getElementById("notesButton").style.display="block"}document.getElementById("statusTotal").value="/ "+presSettings.TotalSlides;document.getElementById("statusCurrent").onkeydown=EnterCurrent;document.getElementById("playN").onclick=Presentation.Next;document.getElementById("playP").onclick=Presentation.Prev;document.getElementById("playB").onclick=Presentation.Play;document.getElementById("playB").onmouseover=function(){if(isPlaying){document.getElementById("playB").style.backgroundPosition="-148px 0px"}else{document.getElementById("playB").style.backgroundPosition="-50px 0px"}};document.getElementById("playB").onmouseout=function(){if(isPlaying){document.getElementById("playB").style.backgroundPosition="-99px 0px"}else{document.getElementById("playB").style.backgroundPosition="-1px 0px"}}}function EnterCurrent(e){var t=e.keyCode||e.which;if(t==13){var n=document.getElementById("statusCurrent").value;if(!isNaN(n)){var r=parseInt(n);Presentation.GotoSlide(r)}}}function currentText(e){var t=(""+presSettings.TotalSlides).length;var n=(""+e).length;if(n==t){return e}if(n==t-1){return"0"+e}if(n==t-2){return"00"+e}return e}function sHp(){var e=document.getElementById("panel");if(e.style.display=="block"){e.style.display="none"}else{e.style.display="block"}pcc.r()}var presSettings={};var Presentation;var isTouchDevice;var ipadKeyPadFlg;var isPlaying=false;window.onload=function(){if(!document.createElement("canvas").getContext){document.getElementById("resizer").innerHTML="";document.getElementById("toolbar").innerHTML="";document.getElementById("toolbar").style.width="0px";document.write("Oops! Your browser does not support HTML5. You need to upgrade your browser to view this content.");return}Presentation=new DopPresentation(new eventsHandler);Presentation.SetRPath("data/");try{document.createEvent("TouchEvent");isTouchDevice=true}catch(e){isTouchDevice=false}Presentation.LoadPres("pres",1)};var eventsHandler=function(){this.OnError=function(){};this.OnLoadingStart=function(){loading.LoadingStart()};this.OnLoadingEnd=function(){loading.LoadingEnd()};this.OnSlideChange=function(e){pcc.HandleSlideChange(e)};this.OnMovToNxtAnim=function(){};this.OnMovToPrvAnim=function(){};this.OnPlayingStart=function(){isPlaying=true;pcc.HandlePlayAndPause(true)};this.OnPlayingEnd=function(){isPlaying=false;pcc.HandlePlayAndPause(false)};this.OnProgressChange=function(e){pcc.HandleProgress(e)};this.InitaliseSettings=function(e){presSettings=e;loadNewPres()}};var loading=function(){function e(){document.getElementById("loadingImg").style.display="block"}function t(){document.getElementById("loadingImg").style.display="none"}return{LoadingStart:e,LoadingEnd:t}}();Pcl=function(){function e(){if(!isTouchDevice)return;if(navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPod/i)){window.iabho=document.createElement("div");document.body.appendChild(window.iabho);window.iabho.style.height="1000px";setTimeout(e(),100);window.scrollTo(0,1);function e(){document.body.removeChild(window.iabho)}}}function t(e){var t=e.toString();if(t.indexOf("e")>0){return Math.floor(e)}return e}this.r=function(){e();var n=window.innerWidth;var r=window.innerHeight;if(navigator.userAgent.match(/iPad/i)){if(window.orc==1&&ipadKeyPadFlg==1){window.orc=0}else if(ipadKeyPadFlg==1){return}}var i=document.getElementById("player");var s=50;var o;var u;if(presSettings.MaxScale>0){if(r>presSettings.Height*presSettings.MaxScale){o=presSettings.Height*presSettings.MaxScale}else{o=r}if(n>presSettings.Width*presSettings.MaxScale){u=presSettings.Width*presSettings.MaxScale}else{u=n}}else{o=r;u=n}var a=0;if(document.getElementById("panel").style.display=="block"){a=250}var f;if(u-a<presSettings.Width||o-s<presSettings.Height){if((presSettings.Width-(u-a))/presSettings.Width<(presSettings.Height-(o-s))/presSettings.Height){f=1-(presSettings.Height-(o-s))/presSettings.Height}else{f=1-(presSettings.Width-(u-a))/presSettings.Width}}else{if((u-a-presSettings.Width)/presSettings.Width>(o-s-presSettings.Height)/presSettings.Height){f=1+(o-s-presSettings.Height)/presSettings.Height}else{f=1+(u-a-presSettings.Width)/presSettings.Width}}Presentation.SetScale(f);if(presSettings.MaxScale==0){u=a+presSettings.Width*f}i.style.height=t(o)+"px";i.style.width=t(u)+"px";i.style.top=t((r-o)/2)+"px";i.style.left=t((n-u)/2)+"px";var l=document.getElementById("resizer");l.style.webkitTransform="scale("+t(f)+")";l.style.MozTransform="scale("+t(f)+")";l.style.OTransform="scale("+t(f)+")";l.style.msTransform="scale("+t(f)+")";var c=document.getElementById("contentHolder");c.style.height=t(presSettings.Height*f)+"px";c.style.width=t(presSettings.Width*f)+"px";var h=t(a+(u-a-f*presSettings.Width)/2);var p=t((o-s-f*presSettings.Height)/2);c.style.marginLeft=h+"px";c.style.marginTop=p+"px";var d=document.getElementById("resizer").parentNode;var v=d.getElementsByTagName("embed");for(var m=v.length-1;m>=0;m--){v[m].style.top=t(v[m].dopFlashPro.top*f)+"px";v[m].style.left=t(v[m].dopFlashPro.left*f)+"px";v[m].style.height=t(v[m].dopFlashPro.height*f)+"px";v[m].style.width=t(v[m].dopFlashPro.width*f)+"px"}var g=document.getElementById("loadingImg");g.style.height=t(presSettings.Height*f)+"px";g.style.width=t(presSettings.Width*f)+"px";g.style.marginTop=p+"px";g.style.marginLeft=h+"px";var y=document.getElementById("panel");document.getElementById("panel").style.height=t(o-s)+"px";document.getElementById("noteDisplay").style.height=t(o-s-40)+"px";document.getElementById("buttonDiv").style.left=t(u/2-25)+"px";var b=document.getElementById("progress");var w=(u/2-70-95)/200;w=w>.8?.8:w;w=w<.33?.33:w;b.style.webkitTransform="scale("+t(w)+",1)";b.style.MozTransform="scale("+t(w)+",1)";b.style.OTransform="scale("+t(w)+",1)";b.style.msTransform="scale("+t(w)+",1)";b.parentNode.style.width=t(w*200)+"px";if(u>427){document.getElementById("time").style.opacity=1;document.getElementById("status").style.opacity=1;b.style.opacity=1;if(y!=null){document.getElementById("notesButton").style.right="65px";document.getElementById("notesButton").style.opacity=1}}else{document.getElementById("time").style.opacity=0;b.style.opacity=0;document.getElementById("status").style.opacity=1;if(y!=null){document.getElementById("notesButton").style.opacity=1}if(u<300){if(y!=null){document.getElementById("notesButton").style.opacity=0}if(!isTouchDevice){document.getElementById("status").style.opacity=0}}}if(document.getElementById("play")!=null){l=document.getElementById("play");l.style.height=t(f*presSettings.Height)+"px";l.style.width=t(f*presSettings.Width)+"px"}};this.HandleProgress=function(e){var t=Math.floor(e/1e3%60);var n=Math.floor(e/1e3/60%60);if(t<10){t="0"+t}if(n<10){n="0"+n}document.getElementById("times").innerHTML=n+":"+t;var r=200/presSettings.TotalTime*e;if(r>200){r=200}document.getElementById("Bar").style.width=r+"px"};this.n=function(e){var t=Presentation.GetNotes(e);document.getElementById("noteDisplay").innerHTML=t};this.HandleSlideChange=function(e){switch(e){case-1:break;case 0:break;default:document.getElementById("statusCurrent").value=currentText(e);presSettings.CurrentSlide=e;pcc.n(e);break}};this.HandlePlayAndPause=function(e){switch(e){case true:document.getElementById("playB").style.backgroundPosition="-99px 0px";break;case false:document.getElementById("playB").style.backgroundPosition="-1px 0px";break;default:break}}};var pcc=new Pcl